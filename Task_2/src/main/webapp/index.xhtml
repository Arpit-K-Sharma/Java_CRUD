<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
<h:head>
    <title>Student CRUD App</title>
</h:head>
<h:body>
    <h:form id="studentForm">

        <!-- Student Form -->
        <p:panel header="Student Form">
            <p:messages id="msgs" autoUpdate="true"/>

            <h:panelGrid columns="2" cellpadding="5">
                <h:outputLabel for="name" value="Name:" />
                <p:inputText id="name" value="#{studentBean.student.name}" required="true"/>

                <h:outputLabel for="address" value="Address:" />
                <p:inputText id="address" value="#{studentBean.student.address}" required="true"/>

                <h:outputLabel for="studentClass" value="Class:" />
                <p:selectOneMenu id="studentClass" value="#{studentBean.student.studentClass}" required="true">
                    <f:selectItem itemLabel="-- Select Class --" itemValue="" />
                    <f:selectItems value="#{studentBean.classList}" />
                    <p:ajax listener="#{studentBean.onClassChange}" update="subject"/>
                </p:selectOneMenu>

                <h:outputLabel for="subject" value="Subject:" />
                <p:selectOneMenu id="subject" value="#{studentBean.student.subject}" required="true">
                    <f:selectItem itemLabel="-- Select Subject --" itemValue="" />
                    <f:selectItems value="#{studentBean.subjectList}" />
                </p:selectOneMenu>
            </h:panelGrid>

            <p:commandButton value="Save" action="#{studentBean.save}" update=":studentForm:table" />

        </p:panel>

        <br/>

        <!-- Student Table -->
        <p:dataTable id="table" value="#{studentBean.studentList}" var="stu" editable="true">
            <p:column headerText="ID">
                <h:outputText value="#{stu.id}" />
            </p:column>

            <p:column headerText="Name">
                <h:outputText value="#{stu.name}" />
            </p:column>

            <p:column headerText="Address">
                <h:outputText value="#{stu.address}" />
            </p:column>

            <p:column headerText="Class">
                <h:outputText value="#{stu.studentClass}" />
            </p:column>

            <p:column headerText="Subject">
                <h:outputText value="#{stu.subject}" />
            </p:column>

            <p:column headerText="Action">
                <p:commandButton value="Edit" icon="pi pi-pencil"
                                 actionListener="#{studentBean.edit(stu)}"
                                 update=":editDialogForm"
                                 oncomplete="PF('editDialog').show();" />

                <p:commandButton value="Delete" icon="pi pi-trash"
                                 action="#{studentBean.delete(stu)}"
                                 update=":studentForm:table" />
            </p:column>
        </p:dataTable>

    </h:form>

    <!-- Edit Dialog -->
    <p:dialog header="Edit Student" widgetVar="editDialog" modal="true" resizable="false">
        <h:form id="editDialogForm">
            <h:panelGrid columns="2" cellpadding="5">
                <h:outputLabel for="editName" value="Name:" />
                <p:inputText id="editName" value="#{studentBean.student.name}" required="true"/>

                <h:outputLabel for="editAddress" value="Address:" />
                <p:inputText id="editAddress" value="#{studentBean.student.address}" required="true"/>

                <h:outputLabel for="editClass" value="Class:" />
                <p:selectOneMenu id="editClass" value="#{studentBean.student.studentClass}" required="true">
                    <f:selectItem itemLabel="-- Select Class --" itemValue="" />
                    <f:selectItems value="#{studentBean.classList}" />
                    <p:ajax listener="#{studentBean.onClassChange}" update="editSubject"/>
                </p:selectOneMenu>

                <h:outputLabel for="editSubject" value="Subject:" />
                <p:selectOneMenu id="editSubject" value="#{studentBean.student.subject}" required="true">
                    <f:selectItem itemLabel="-- Select Subject --" itemValue="" />
                    <f:selectItems value="#{studentBean.subjectList}" />
                </p:selectOneMenu>
            </h:panelGrid>

            <p:commandButton value="Update" action="#{studentBean.save}"
                             oncomplete="PF('editDialog').hide();"
                             update=":studentForm:table" />
        </h:form>
    </p:dialog>

</h:body>
</html>
